<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calboard - Settings</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="admin.css">
</head>
<body>
  <div class="admin-container">
    <!-- Login Modal -->
    <div class="modal" id="login-modal">
      <div class="modal-content">
        <h2>Admin Login</h2>
        <p>Enter the admin password to access settings.</p>
        <form id="login-form">
          <div class="form-group">
            <label for="login-password">Password</label>
            <input type="password" id="login-password" required>
          </div>
          <button type="submit" class="btn btn-primary">Login</button>
        </form>
        <div class="error-message" id="login-error"></div>
      </div>
    </div>

    <!-- Header -->
    <header class="admin-header">
      <div class="header-left">
        <h1>Calboard Settings</h1>
        <a href="/" class="back-link">← Back to Dashboard</a>
      </div>
      <div class="header-right">
        <button class="btn btn-secondary" id="reload-btn">Reload Config</button>
        <button class="btn btn-primary" id="save-btn">Save Changes</button>
      </div>
    </header>

    <!-- Status Messages -->
    <div class="status-bar" id="status-bar"></div>

    <!-- Main Content -->
    <main class="admin-main">
      <!-- Weather Settings -->
      <section class="settings-section">
        <h2>Weather Settings</h2>
        <div class="settings-card">
          <div class="form-row">
            <div class="form-group">
              <label for="weather-api-key">OpenWeatherMap API Key</label>
              <div class="input-with-button">
                <input type="password" id="weather-api-key" placeholder="Enter your API key">
                <button type="button" class="btn btn-small" id="toggle-api-key">Show</button>
              </div>
              <span class="help-text">Get a free key at <a href="https://openweathermap.org/api" target="_blank">openweathermap.org</a></span>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="weather-lat">Latitude</label>
              <input type="number" id="weather-lat" step="0.0001" placeholder="30.2672">
            </div>
            <div class="form-group">
              <label for="weather-lon">Longitude</label>
              <input type="number" id="weather-lon" step="0.0001" placeholder="-97.7431">
            </div>
            <div class="form-group">
              <label for="weather-units">Units</label>
              <select id="weather-units">
                <option value="imperial">Imperial (°F, mph)</option>
                <option value="metric">Metric (°C, m/s)</option>
              </select>
            </div>
          </div>
          <div class="form-actions">
            <button type="button" class="btn btn-secondary" id="test-weather-btn">Test Connection</button>
            <span class="test-result" id="weather-test-result"></span>
          </div>
        </div>
      </section>

      <!-- Calendar Settings -->
      <section class="settings-section">
        <h2>Calendars</h2>
        <div class="settings-card">
          <div id="calendars-list" class="calendars-list">
            <!-- Calendar items will be added here dynamically -->
          </div>
          <button type="button" class="btn btn-secondary" id="add-calendar-btn">+ Add Calendar</button>
        </div>
      </section>

      <!-- Display Settings -->
      <section class="settings-section">
        <h2>Display Settings</h2>
        <div class="settings-card">
          <div class="form-row">
            <div class="form-group">
              <label for="display-days">Days to Show</label>
              <input type="number" id="display-days" min="1" max="14" value="7">
            </div>
            <div class="form-group">
              <label for="display-refresh">Refresh Interval (minutes)</label>
              <input type="number" id="display-refresh" min="1" max="60" value="5">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="display-time-format">Time Format</label>
              <select id="display-time-format">
                <option value="12h">12 Hour (AM/PM)</option>
                <option value="24h">24 Hour</option>
              </select>
            </div>
            <div class="form-group">
              <label for="display-date-format">Date Locale</label>
              <select id="display-date-format">
                <option value="en-US">English (US)</option>
                <option value="en-GB">English (UK)</option>
                <option value="de-DE">German</option>
                <option value="fr-FR">French</option>
                <option value="es-ES">Spanish</option>
              </select>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group full-width">
              <label for="display-background">Background Image Path</label>
              <input type="text" id="display-background" placeholder="/backgrounds/image.jpg">
              <span class="help-text">Place images in the public/backgrounds/ folder</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Server Settings -->
      <section class="settings-section">
        <h2>Server Settings</h2>
        <div class="settings-card">
          <div class="form-row">
            <div class="form-group">
              <label for="server-port">Port</label>
              <input type="number" id="server-port" min="1" max="65535" value="3000">
              <span class="help-text">Requires restart to take effect</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Admin Settings -->
      <section class="settings-section">
        <h2>Admin Security</h2>
        <div class="settings-card">
          <div class="form-row">
            <div class="form-group full-width">
              <label for="admin-password">Admin Password</label>
              <input type="password" id="admin-password" placeholder="Leave blank for no password">
              <span class="help-text">Set a password to protect this settings page. Leave blank to disable authentication.</span>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Calendar Item Template -->
  <template id="calendar-template">
    <div class="calendar-item" data-index="">
      <div class="calendar-header">
        <div class="calendar-color-preview" style="background-color: #4CAF50;"></div>
        <span class="calendar-name">Calendar Name</span>
        <button type="button" class="btn btn-icon btn-danger remove-calendar-btn" title="Remove">×</button>
      </div>
      <div class="calendar-details">
        <div class="form-row">
          <div class="form-group">
            <label>Name</label>
            <input type="text" class="calendar-name-input" placeholder="Calendar name">
          </div>
          <div class="form-group">
            <label>Color</label>
            <input type="color" class="calendar-color-input" value="#4CAF50">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group full-width">
            <label>ICS URL</label>
            <input type="url" class="calendar-url-input" placeholder="https://calendar.google.com/calendar/ical/.../basic.ics">
          </div>
        </div>
        <div class="form-actions">
          <button type="button" class="btn btn-small btn-secondary test-calendar-btn">Test URL</button>
          <span class="test-result calendar-test-result"></span>
        </div>
      </div>
    </div>
  </template>

  <script src="admin.js"></script>
</body>
</html>
